Chimera HMM Viterbi 

Этот скрипт демонстрирует работу скрытых марковских моделей (HMM) для анализа химерных последовательностей ДНК и для сегментации вашей последовательности между двумя моделями-референсами.

Требования

    Python 3.6+
    Библиотеки: numpy, biopython, matplotlib

Запуск

1. Генерация химеры и оценка точности (режим run)

Скрипт создает химерную последовательность из двух FASTA-файлов и вычисляет точность восстановления скрытых состояний алгоритмом Витерби.

Пример использования:

python script.py run --dbdir /path/to/db --length 10000 --fragmean 300 --seed 42

    --dbdir — директория c двумя FASTA-файлами для химерной последовательности.
    --length — длина химерной последовательности.
    --fragmean — средняя длина фрагмента (осуществляется смена источника).
    --seed — random seed для воспроизводимости.

В результате появляется график (если установлен matplotlib) и в консоли печатается точность предсказания скрытых состояний Viterbi.



2. Классификация исходной последовательности по моделям из папки (режим test)

В этом режиме вы подаете свой FASTA-файл и папку с моделями (FASTA-референсами), после чего скрипт использует эмиссионные вероятности двух первых файлов из папки и применяет алгоритм Витерби для сегментации вашей последовательности.

Пример использования:

python script.py test myseq.fasta --dbdir /path/to/db --out viterbi_result.json

    myseq.fasta — ваш FASTA-файл с ДНК-последовательностью.
    --dbdir — директория c двумя FASTA-файлами для сравнения.
    --fragmean — средняя длина "однотипного" блока. По умолчанию 300.
    --out — имя выходного файла с результатами (по умолчанию в той же папке, в формате JSON).

В результате в файл (viterbi_result.json) сохраняется путь скрытых состояний последовательности и используемые вероятности.


Пример содержимого выходного файла:
JSON

{
  "states": "111222222211111112...",
  "emiss_probs": {
    "file1": "dbseqA.fasta", "emi1": {"A": 0.28, "T": ...},
    "file2": "dbseqB.fasta", "emi2": {"A": 0.25, "T": ...},
    "p_stay": 0.9967,
    "p_switch": 0.0033
  }
}

